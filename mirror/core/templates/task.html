{% load static %}
<div id="tsk-add-panel" class="w-full p-10 px-16 bg-white rounded-lg shadow-lg hidden flex flex-col items-center">
    <div class="text-center mb-8 w-full">
        <h1 class="text-3xl font-bold text-gray-900">Create Your Task</h1>
        <p class="text-gray-500 mt-2">Please select the details below to create your task.</p>
    </div>

    <form action="{% url 'add_task' %}" method="POST" id='addTskForm' class="pt-6 w-2/3">
        {% csrf_token %}
        <div class="space-y-4 text-sm">
            <div class="grid grid-cols-5 gap-x-8 gap-y-4">

                <div class="col-span-2 flex flex-col pr-10">
                    <label for="sample" class="text-sm font-medium text-gray-700">* Sample</label>
                    <select id="sample" name="sample" class="w-full bg-white border-0 border-b-2 border-grey-800 outline-none px-4 py-2 focus:outline-none focus:border-blue-700" data-required>
                                    <option value="">Please select a Sample</option>
                                    {% for item in samples %}
                                        <option value="{{ item.id }}">{{ item.name }}</option>
                                    {% endfor %}
                    </select>
                </div>
                <div class="col-span-3 flex flex-col pr-10"></div>
                <div class="col-span-2 flex flex-col pr-10">
                    <label for="contact" class="text-sm font-medium text-gray-700">* Issue Contact</label>
                    <select id="contact" name="contact" class="w-full bg-white border-0 border-b-2 border-grey-800 outline-none px-4 py-2 focus:outline-none focus:border-blue-700" data-required>
                                    <option value="">Please select Contact</option>
                                    {% for item in users %}
                                        <option value="{{ item.id }}">{{ item.name }}</option>
                                    {% endfor %}
                    </select>
                </div>
                <div class="col-span-3 flex flex-col pr-10"></div>
                <div class="col-span-5 flex flex-col pr-10">
                    <label for="last_name" class="text-sm font-medium text-gray-700">* Select a task configuration</label>
                    <fieldset class="space-y-3 grid grid-cols-1 md:grid-cols-3 gap-x-8 gap-y-4 items-stretch" data-required>
                        <legend class="sr-only">Task Category</legend>

                          <div class="flex flex-col">
                            <label for="installOnly" class="flex items-center justify-between gap-4 rounded border border-gray-300 bg-white p-3 text-sm font-medium shadow-sm transition-colors hover:bg-gray-50 has-checked:border-blue-600 has-checked:ring-1 has-checked:ring-blue-600 tsk-cat-label-i">
                              <div>
                                <p class="text-gray-700">Installation only</p>
                                <p class="text-gray-900">Select an OS image and install OS without run any testcases</p>
                              </div>                        

                              <input type="radio" name="taskCategory" value="i" id="installOnly" class="size-5 border-gray-300"/>
                            </label>
                          </div>

                          <div class="flex flex-col">
                            <label for="tcOnly" class="flex items-center justify-between gap-4 rounded border border-gray-300 bg-white p-3 text-sm font-medium shadow-sm transition-colors hover:bg-gray-50 has-checked:border-blue-600 has-checked:ring-1 has-checked:ring-blue-600 tsk-cat-label-t">
                              <div>
                                <p class="text-gray-700">Test Cases only</p>
                                <p class="text-gray-900">Select testcases and run without re-install the OS image</p>
                              </div>                        

                              <input type="radio" name="taskCategory" value="t" id="tcOnly" class="size-5 border-gray-300"/>
                            </label>
                          </div>

                          <div class="flex flex-col">
                            <label for="combination" class="flex items-center justify-between gap-4 rounded border bg-white p-3 text-sm font-medium shadow-sm transition-colors hover:bg-gray-50 has-checked:border-blue-600 has-checked:ring-1 has-checked:ring-blue-600 tsk-cat-label-c border-blue-700">
                              <div>
                                <p class="text-gray-700">Installation and Test Cases</p>
                                <p class="text-gray-900">Install selected OS image and run selected testcases</p>
                              </div>                        

                              <input type="radio" name="taskCategory" value="f" id="combination" class="size-5 border-gray-300" checked/>
                            </label>
                          </div>
                    </fieldset>
                </div>
                <div class="col-span-2 flex flex-col pr-10">
                    <label for="image" class="text-sm font-medium text-gray-700">OS Image</label>
                    <select id="image" name="image" class="w-full bg-white border-0 border-b-2 border-grey-800 outline-none px-4 py-2 focus:outline-none focus:border-blue-700">
                                    <option value="">Please select an OS image</option>
                                    {% for item in images %}
                                        <option value="{{ item.id }}">{{ item.name }}</option>
                                    {% endfor %}
                    </select>
                </div>
                <div class="col-span-3 flex flex-col pr-10"></div>
                <div class="col-span-2 flex flex-col pr-10">
                    <label for="testcases" class="text-sm font-medium text-gray-700" data-required>* Select TestCases</label>
                    <div class="py-4">
                        {% for item in testcases %}
                          <label for="{{ item.id }}" class="flex items-center cursor-pointer select-none py-2">
                            <input type="checkbox" name="testcases" id="{{ item.id }}" value="{{ item.id }}" class="form-checkbox text-indigo-600 rounded">
                            <span class="ml-2 text-gray-700">{{ item.name }}</span>
                          </label>
                        {% endfor %}
                    </div>
                </div>
                <div class="col-span-3 flex flex-col pr-10"></div>
            </div>
        </div>

        <div class="mt-8 items-center text-center text-sm">
            <button type="submit" id="submit-add-tsk-form" data-action="submitAddTskForm" class="action-btn bg-blue-500 text-white px-6 py-2 rounded-lg font-medium shadow-md hover:bg-blue-600 transition-colors duration-200">Create</button>
            <a id="cancel-add-tsk" data-action="hideAddTskPanel" class="action-btn text-gray-400 ml-auto px-20 transition hover:text-blue-700 cursor-pointer transition-colors duration-200">Cancel</a>
        </div>

    </form>

</div>

<!-- Top Tasks -->
<div class="bg-white rounded-lg shadow-lg p-10 px-16 mt-6 overflow-x-auto">
    <div class="flex items-center justify-between">
        <h2 class="text-xl font-semibold mb-4">Top Tasks</h2>
        <a  id="btn-show-tsk-add-form" data-action="showAddTskPanel" class="action-btn text-blue-400 transition hover:text-blue-700 cursor-pointer transition-colors duration-200">Schedule a new task ></a>
    </div>
    <table class="table-fixed min-w-full divide-y divide-grey-200 text-left">
        <thead class="bg-grey-100 whitespace-nowrap">
            <tr class="bg-grey-100 text-sm">
                <th class="px-4 py-2 uppercase tracking-wider font-normal">ID</th>
                <th class="px-4 py-2 uppercase tracking-wider font-normal">SKU/Platform</th>
                <th class="px-4 py-2 uppercase tracking-wider font-normal">Task Type</th>
                <th class="px-4 py-2 uppercase tracking-wider font-normal">Image/Kernel</th>
                <th class="px-4 py-2 uppercase tracking-wider font-normal">Status</th>
                <th class="px-4 py-2 uppercase tracking-wider font-normal">Trigger</th>
                <th class="px-4 py-2 uppercase tracking-wider font-normal">Log</th>
                <th class="px-4 py-2 uppercase tracking-wider font-normal w-[10px]"></th>
            </tr>
        </thead>
        <tbody class="bg-white divide-y divide-grey-200 whitespace-nowrap">
            {% for item in task_list %}
                <tr class="bg-white  text-xs">
                <td class="px-4 py-2">#{{ item.id }}</td>
                <td class="px-4 py-2">
                    <div class="flex items-center">
                        <div class="ml-4">
                            <p class="font-semibold">{{ item.dpn }}</p>
                            <p class="text-sm text-gray-500">{{ item.platform_name }}</p>
                        </div>
                    </div>
                </td>
                <td class="px-4 py-2">
                    <div class="flex space-x-2 relative group">
                        {% if item.type == "i" %}
                            <span class="bg-blue-500 w-6 h-6 text-white text-sm flex items-center justify-center rounded-full cursor-pointer">I</span>
                            <div class="absolute z-10 left-10 top-2 -translate-y-1/2 ml-2 p-2 bg-white border border-grey-400 text-gray-700 text-xs rounded-lg shadow-lg whitespace-nowrap opacity-0 transition-all duration-300 group-hover:visible group-hover:opacity-100">Installation only</div>
                        {% elif item.type == "t" %}
                            <span class="bg-purple-500 w-6 h-6 text-white text-sm flex items-center justify-center rounded-full cursor-pointer">T</span>
                            <div class="absolute z-10 left-10 top-2 -translate-y-1/2 ml-2 p-2 bg-white border border-grey-400 text-gray-700 text-xs rounded-lg shadow-lg whitespace-nowrap opacity-0 transition-all duration-300 group-hover:visible group-hover:opacity-100">Test Case only</div>
                        {% elif item.type == "f" %}
                            <span class="bg-green-500 w-6 h-6 text-white text-sm flex items-center justify-center rounded-full cursor-pointer">F</span>
                            <div class="absolute z-10 left-10 top-2 -translate-y-1/2 ml-2 p-2 bg-white border border-grey-400 text-gray-700 text-xs rounded-lg shadow-lg whitespace-nowrap opacity-0 transition-all duration-300 group-hover:visible group-hover:opacity-100">Full test</div>
                        {% endif %}
                    </div>
                </td>
                <td class="px-4 py-2">
                    <span class="bg-blue-100 text-blue-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm dark:bg-blue-900 dark:text-blue-300">{{ item.image_cat }}</span>
                    <span class="bg-indigo-100 text-indigo-800 text-xs font-medium me-2 px-2.5 py-0.5 rounded-sm dark:bg-indigo-900 dark:text-indigo-300">{{ item.kernel_ver }}</span>
                </td>
                <td class="px-4 py-2 relative group">
                    {% if item.st == '11' %}
                        <span class="w-4 h-4 bg-yellow-500 block rounded-full cursor-pointer tskSt" tskId="{{ item.id}}"></span>
                        <div class="absolute z-10 left-10 top-2 -translate-y-1/2 ml-2 p-2 bg-white border border-grey-400 text-gray-700 text-xs rounded-lg shadow-lg whitespace-nowrap opacity-0 transition-all duration-300 group-hover:visible group-hover:opacity-100">Pending</div>
                    {% elif item.st == '12' %}
                        <span class="w-4 h-4 bg-red-500 block rounded-full cursor-pointer tskSt" tskId="{{ item.id}}"></span>
                        <div class="absolute z-10 left-10 top-2 -translate-y-1/2 ml-2 p-2 bg-white border border-grey-400 text-gray-700 text-xs rounded-lg shadow-lg whitespace-nowrap opacity-0 transition-all duration-300 group-hover:visible group-hover:opacity-100">Running</div>
                    {% elif item.st == '13' %}
                        <span class="w-4 h-4 bg-green-500 block rounded-full cursor-pointer tskSt" tskId="{{ item.id}}"></span>
                        <div class="absolute z-10 left-10 top-2 -translate-y-1/2 ml-2 p-2 bg-white border border-grey-400 text-gray-700 text-xs rounded-lg shadow-lg whitespace-nowrap opacity-0 transition-all duration-300 group-hover:visible group-hover:opacity-100">Complete</div>
                    {% elif item.st == '14' %}
                        <span class="w-4 h-4 bg-gray-600 block rounded-full cursor-pointer tskSt" tskId="{{ item.id}}"></span>
                        <div class="absolute z-10 left-10 top-2 -translate-y-1/2 ml-2 p-2 bg-white border border-grey-400 text-gray-700 text-xs rounded-lg shadow-lg whitespace-nowrap opacity-0 transition-all duration-300 group-hover:visible group-hover:opacity-100">Cancelled</div>
                    {% elif item.st == '00' %}
                        <span class="w-4 h-4 bg-gray-200 block rounded-full cursor-pointer tskSt" tskId="{{ item.id}}"></span>
                        <div class="absolute z-10 left-10 top-2 -translate-y-1/2 ml-2 p-2 bg-white border border-grey-400 text-gray-700 text-xs rounded-lg shadow-lg whitespace-nowrap opacity-0 transition-all duration-300 group-hover:visible group-hover:opacity-100">Unknown</div>
                    {% endif %}
                </td>
                <td class="px-4 py-2">
                    <div class="flex items-center">
                        <img src="{% static 'core/img/avatar_default.png' %}" class="w-6 h-6 rounded-full">
                        <div class="ml-4">
                            <p class="font-semibold">{{ item.trigger_by }}</p>
                            <p class="text-sm text-gray-500">{{ item.trigger_at }}</p>
                        </div>
                    </div>
                </td>
                <td class="px-4 py-2 flex item-center justify-center cursor-pointer hover:text-blue-500 ">
                    {% if item.st == '13' %}
                    <span class="text-grey-500 text-sm font-xs mt-2 underline">logs</span>
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4 mt-2 ml-2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" />
                    </svg>
                    {% endif %}
                </td>
                <td class="px-4 py-2 w-[10px] whitespace-nowrap">
                    {% if item.st == '11' %}
                    <span class="action-btn inline-block px-4 py-2 rounded-full bg-grey-400 text-blue-500 cursor-pointer hover:bg-red-500 hover:text-white hover:border hover: border-grey-400 transition-colors" value="{{ item.id }}" id="btn-cancel-tsk" data-action="cancelTask" >Cancel</span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>