<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Linux Team Automatic Test Lab</title>
  <link href="{% static '/core/css/tailwind.min.css' %}" rel="stylesheet">
  <style>
    @font-face {
        font-family: Poppins;
        src: url("{% static '/core/fonts/Poppins-Black.ttf' %}") format('truetype');
        font-weight: 900;
        font-style: black;
    }
    @font-face {
        font-family: Poppins;
        src: url("{% static '/core/fonts/Poppins-Bold.ttf' %}") format('truetype');
        font-weight: 700;
        font-style: bold;
    }
    @font-face {
        font-family: Poppins;
        src: url("{% static '/core/fonts/Poppins-Light.ttf' %}") format('truetype');
        font-weight: 300;
        font-style: light;
    }
    @font-face {
        font-family: Poppins;
        src: url("{% static '/core/fonts/Poppins-Regular.ttf' %}") format('truetype');
        font-weight: 400;
        font-style: normal;
    }
    .light-text {
        font-family: 'Poppins', sans-serif;
        font-weight: light;
    }
    .regular-text {
        font-family: 'Poppins', sans-serif;
        font-weight: normal;
    }
    .bold-text {
        font-family: 'Poppins', sans-serif;
        font-weight: bold;
    }
    .black-text {
        font-family: 'Poppins', sans-serif;
        font-weight: black;
    }
    .nav-link {
        color: #A1A2A6;
    }
    .nav-link:hover {
        color: #1F253A;
        background-color: #F7FAFF;
        transition: background-color 0.2s easy-in-out;
    }
    .nav-link:hover p {
        color: #1F253A;
    }
    .nav-act{
        color: #5E5AFE;
        background-color: #F2F1FF;
        background-image: linear-gradient(to right, #F2F1FF, #FFFFFF 20%);
        background-size: 200% 100%;
        background-position: left;
        transition: background-position 0.2s easy-in-out;
    }
    .nav-act p{
        color: #5E5AFE;
    }
    .nav-deact {
        color: #A1A2A6;
    }
    .nav-deact p{
        color: #A1A2A6;
    }
    body {
      font-family: 'Roboto', sans-serif;
      background-color: #F7FAFF;
    }
    .c-title {
        color: #605BDF;
    }
    .content-panel {
        background-color: #F7FAFF;
    }
    .search-bg {
        background-color: #F7FAFF;     
    }
    .tr-panel-0{
        background-color: #3B76EE;
    }
    .tr-panel-1{
        background-color: #62C7FF;
    }
    .tr-panel-2{
        background-color: #A66DD4;
    }
    .tr-panel-3{
        background-color: #6CD4B1;
    }
    .tr-conta:hover{
        transform: translateY(-8px) scale(1.02);
        box-shadow: 0 10px 20px rgb(0, 0, 0, 0.15);
    }
    .content-panel{
        display: flex;
        flex-direction: column;
        min-height: 100vh;
    }
    .content-wrap{
        flex-grow: 1;
    }
  </style>
</head>
<body class="bg-gray-100 text-gray-700 regular-text">
  <script src="{% static 'core/js/chart.js' %}"></script>
  <div class="flex min-h-screen">
    <!-- Sidebar -->
    <aside class="bg-white pt-12 space-y-8 text-grey-400 sticky top-0 h-screen">
      <div class="text-xl item-center font-bold flex items-center justify-center text-grey-600 c-title regular-text">Linux <span>Test Lab</span></div>
      <nav class="space-y-3">
        <div class="flex item-center py-2 rounded nav-link nav-act" data-url='/index/dashboard/'>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" class="w-6 h-6 ml-6 mt-2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6A2.25 2.25 0 0 1 6 3.75h2.25A2.25 2.25 0 0 1 10.5 6v2.25a2.25 2.25 0 0 1-2.25 2.25H6a2.25 2.25 0 0 1-2.25-2.25V6ZM3.75 15.75A2.25 2.25 0 0 1 6 13.5h2.25a2.25 2.25 0 0 1 2.25 2.25V18a2.25 2.25 0 0 1-2.25 2.25H6A2.25 2.25 0 0 1 3.75 18v-2.25ZM13.5 6a2.25 2.25 0 0 1 2.25-2.25H18A2.25 2.25 0 0 1 20.25 6v2.25A2.25 2.25 0 0 1 18 10.5h-2.25a2.25 2.25 0 0 1-2.25-2.25V6ZM13.5 15.75a2.25 2.25 0 0 1 2.25-2.25H18a2.25 2.25 0 0 1 2.25 2.25V18A2.25 2.25 0 0 1 18 20.25h-2.25A2.25 2.25 0 0 1 13.5 18v-2.25Z" />
            </svg>
            <p class="py-2 pr-10 pl-4 text-base font-normal">Dashboard</p>
        </div>
        <div class="flex item-center py-2 rounded nav-link nav-deact" data-url='/index/sample/'>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" class="w-6 h-6 ml-6 mt-2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 20.25h12m-7.5-3v3m3-3v3m-10.125-3h17.25c.621 0 1.125-.504 1.125-1.125V4.875c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125Z" />
            </svg>
            <p class="py-2 pr-10 pl-4 text-base font-normal">Samples</p>
        </div>
        <div class="flex item-center py-2 rounded nav-link nav-deact" data-url='/index/task/'>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" class="w-6 h-6 ml-6 mt-2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 12h16.5m-16.5 3.75h16.5M3.75 19.5h16.5M5.625 4.5h12.75a1.875 1.875 0 0 1 0 3.75H5.625a1.875 1.875 0 0 1 0-3.75Z" />
            </svg>
            <p class="py-2 pr-10 pl-4 text-base font-normal">Tasks</p>
        </div>
        <div class="flex item-center py-2 rounded nav-link nav-deact" data-url='/index/image/'>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" class="w-6 h-6 ml-6 mt-2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
            </svg>
            <p class="py-2 pr-10 pl-4 text-base font-normal">Images</p>
        </div>
        <div class="flex item-center py-2 rounded nav-link nav-deact" data-url='/index/testcase/'>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" class="w-6 h-6 ml-6 mt-2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125M3.375 19.5h7.5c.621 0 1.125-.504 1.125-1.125m-9.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-7.5A1.125 1.125 0 0 1 12 18.375m9.75-12.75c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125m19.5 0v1.5c0 .621-.504 1.125-1.125 1.125M2.25 5.625v1.5c0 .621.504 1.125 1.125 1.125m0 0h17.25m-17.25 0h7.5c.621 0 1.125.504 1.125 1.125M3.375 8.25c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m17.25-3.75h-7.5c-.621 0-1.125.504-1.125 1.125m8.625-1.125c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h7.5m-7.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M12 10.875v-1.5m0 1.5c0 .621-.504 1.125-1.125 1.125M12 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125M13.125 12h7.5m-7.5 0c-.621 0-1.125.504-1.125 1.125M20.625 12c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h7.5M12 14.625v-1.5m0 1.5c0 .621-.504 1.125-1.125 1.125M12 14.625c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m0 1.5v-1.5m0 0c0-.621.504-1.125 1.125-1.125m0 0h7.5" />
            </svg>
            <p class="py-2 pr-10 pl-4 text-base font-normal">Test Cases</p>
        </div>
        <div class="flex item-center py-2 rounded nav-link nav-deact" data-url='/index/platform/'>
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" class="w-6 h-6 ml-6 mt-2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M6 6.878V6a2.25 2.25 0 0 1 2.25-2.25h7.5A2.25 2.25 0 0 1 18 6v.878m-12 0c.235-.083.487-.128.75-.128h10.5c.263 0 .515.045.75.128m-12 0A2.25 2.25 0 0 0 4.5 9v.878m13.5-3A2.25 2.25 0 0 1 19.5 9v.878m0 0a2.246 2.246 0 0 0-.75-.128H5.25c-.263 0-.515.045-.75.128m15 0A2.25 2.25 0 0 1 21 12v6a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18v-6c0-.98.626-1.813 1.5-2.122" />
            </svg>
            <p class="py-2 pr-10 pl-4 text-base font-normal">Platforms</p>
        </div>
      </nav>
    </aside>

    <div class="flex-1 p-6 space-y-6 content-panel">
        <!-- Top Bar (always keep in the top of the right panel)-->
        <div class="w-full flex items-center bg-grey-100 border-0 border-b-2 border-gray-200 p-4 mb-10">
            <!-- Search box in the center -->
            <div class="flex items-center p-2 bg-gray-100 search-bg">
		        <svg class="h-7 w-7 text-gray-500 mx-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    		      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
  		        </svg>
                <input type="text" placeholder="Search here..." class="w-full max-w-md  bg-gray-100 border-0 border-l-2 border-grey-800 search-bg outline-none px-4 py-2 focus:outline-none focus:border-blue-700 hover:border-blue-700" />
            </div>
            <!-- User Avatar  (register/login) -->
            <div class="ml-auto mr-4">
                <img src="{% static 'core/img/avatar_linux.png' %}" alt="User Avatar" class="w-10 h-10 rounded-full border-2 border-gray-300">
            </div>
        </div>  

        <!-- Right panel for Main Content -->
        <main class="flex-1 space-y-6 mt-8 content-wrap" id="main-content">
            {% block content %}
            {% endblock %}
        </main>

    	<!-- footer -->
    	<div class="mt-16 border-t border-gray-200 pt-8 flex items-center c-footer">
          	  <ul class="flex flex-wrap justify-center gap-4 text-xs">
                <li>
                  <a href="#" class="text-gray-500 transition hover:opacity-75"> 2025 © XXX. - Designed by XXX</a>
                </li>
              </ul>
        </div>
    </div> <!--End of div for right main content panel  -->

    {% block extra_js %}
    {% endblock %}
    <script>
        document.addEventListener('DOMContentLoaded', function(){
            const links = document.querySelectorAll('.nav-link');
            const contentDiv = document.getElementById('main-content');

            links.forEach(link => {
                link.addEventListener('click', function(event){
                    const currentActiveLink = document.getElementsByClassName('nav-act')[0];
                    currentActiveLink.classList.add('nav-deact');
                    currentActiveLink.classList.remove('nav-act');
                    event.target.closest('div').classList.add('nav-act');
                    event.target.closest('div').classList.remove('nav-deact');
                    event.preventDefault();
                    const url = this.getAttribute('data-url');


                    fetch(url)
                        .then(response =>{
                            if (!response.ok){
                                throw new Error('Network response was not ok');
                            }
                            return response.text();
                        })
                        .then(html => {
                            contentDiv.innerHTML = html;
                            if(url == '/index/dashboard/'){
                                // dynamically render the charts in dashboard
                                renderChartsInDashboard()
                            }
                            if(url == '/index/task/'){
                                // add function to listen radio change
                                const taskCatRadio = document.querySelectorAll('input[name="taskCategory"]')
                                const installLabel = document.getElementsByClassName('tsk-cat-label-i')[0]
                                const testLabel = document.getElementsByClassName('tsk-cat-label-t')[0]
                                const combLabel = document.getElementsByClassName('tsk-cat-label-c')[0]
                                taskCatRadio.forEach(radio => {
                                    radio.addEventListener('change', () => {
                                        if (radio.checked) {
                                            if ( radio.id === "installOnly"){
                                                document.getElementById('image').disabled = false
                                            }
                                            else if ( radio.id === "combination"){
                                                document.getElementById('image').disabled = false
                                            }
                                            else{
                                                document.getElementById('image').selectedIndex = 0
                                                document.getElementById('image').disabled = true
                                            }

                                            taskCatRadio.forEach(i => {
                                                i.closest('label').classList.remove('border-blue-700')
                                                i.closest('label').classList.add('border-grey-300')
                                            });
                                            radio.closest('label').classList.remove('border-grey-300')
                                            radio.closest('label').classList.add('border-blue-700')
                                        }
                                    });
                                });
                            }
                        })
                        .catch(error => {
                            contentDiv.innerHTML = "<p class='text-red-500'>Error loading content. </p>";
                        });
                });
            });

            contentDiv.addEventListener('click', function(e){
                const clickedButton = e.target.closest('.action-btn');  

                if(clickedButton){
                    e.preventDefault(); 

                    const actionEvt = clickedButton.dataset.action;
                    const actionId = clickedButton.dataset.actionId;    

                    if(actionEvt === 'showAddSplPanel'){
                        const addSplPanel = document.getElementById('spl-add-panel');
                        const addSplForm = document.getElementById('addSplForm');
                        addSplForm.reset();
                        addSplPanel.classList.remove('hidden')
                    }else if(actionEvt === 'hideAddSplPanel'){
                        const addSplPanel = document.getElementById('spl-add-panel');
                        addSplPanel.classList.add('hidden')
                    }else if(actionEvt === 'submitAddSplForm'){
                        const addSplForm = document.getElementById('addSplForm');   
    

                        const requiredInputs = addSplForm.querySelectorAll('[data-required]');
                        let allFieldValid = true
                        requiredInputs.forEach(input => {
                            if (input.value.trim() === ''){
                                input.classList.add('text-red-500');
                                input.classList.remove('text-grey-700')
                                allFieldValid = false
                            }else{
                                input.classList.remove('text-red-500');
                                input.classList.add('text-grey-800')
                            }
                        });
                        if (allFieldValid){
                            const formData = new FormData(addSplForm);      

                            const csrfToken = formData.get('csrfmiddlewaretoken');
                            if(!csrfToken){
                                alert('csrf token error')
                            }
                            fetch(addSplForm.action, {
                                method: 'POST',
                                headers: {
                                    'X-CSRFToken': csrfToken,
                                },
                                body: formData,
                            })
                            .then(response =>{
                                if(response.ok){
                                    const addSplPanel = document.getElementById('spl-add-panel');
                                    addSplPanel.classList.add('hidden')
                                    addSplForm.reset();
                                }
                            })
                        }
                    }else if(actionEvt === 'showAddTskPanel'){
                        const addSplPanel = document.getElementById('tsk-add-panel');
                        const addSplForm = document.getElementById('addTskForm');
                        addSplForm.reset();
                        addSplPanel.classList.remove('hidden')
                    }else if(actionEvt === 'hideAddTskPanel'){
                        const addSplPanel = document.getElementById('tsk-add-panel');
                        addSplPanel.classList.add('hidden')
                    }else if(actionEvt === 'submitAddTskForm'){
                        const addTskForm = document.getElementById('addTskForm');
                        const formData = new FormData(addTskForm);  

                        const csrfToken = formData.get('csrfmiddlewaretoken');
                        if(!csrfToken){
                            alert('csrf token error')
                        }
                        fetch(addTskForm.action, {
                            method: 'POST',
                            headers: {
                                'X-CSRFToken': csrfToken,   

                            },
                            body: formData,
                        })
                        .then(response =>{
                            if(response.ok){
                                const addTskPanel = document.getElementById('tsk-add-panel');
                                addTskPanel.classList.add('hidden')
                                addTskForm.reset();
                            }
                        })
                    }
                }
            })

        });
    </script>
</body>
</html>
